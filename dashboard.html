<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>Dashboard — My Life Care</title><link rel="stylesheet" href="site.css"></head>
<body>
<header class="header"><div class="wrap container"><div class="brand">My Life Care</div></div></header>

<main class="container" style="padding:28px 0">
  <h2>Dashboard</h2>
  <div id="welcome" style="margin-top:12px"></div>
  <div style="margin-top:18px" id="adminOrders"></div>
</main>

<footer class="site-footer container">© 2025 My Life Care</footer>

<script>
const user = JSON.parse(localStorage.getItem('mlcUser') || 'null');
if(!user){ alert('Please login'); location.href='login.html' }
document.getElementById('welcome').innerHTML = <strong>Welcome, ${user.name||user.email}</strong>;

function loadAllOrders(){
  fetch('/all-orders').then(r=>r.json()).then(data=>{
    const el = document.getElementById('adminOrders');
    if(!data || data.length===0) return el.innerHTML='<div class="sign-card">No orders yet.</div>';
    el.innerHTML = data.map(o=>`<div style='margin-bottom:12px;padding:12px;background:#fff;border-radius:10px;box-shadow:var(--shadow)'>
      <strong>Order ${o.id}</strong><br>
      Email: ${o.email}<br>
      Total: ₹${o.total}<br>
      Items: ${o.items.length}
    </div>`).join('');
  }).catch(()=>document.getElementById('adminOrders').innerHTML='<div class="sign-card">Unable to load orders</div>');
}

// auto load if admin: (you can add user.isAdmin on server)
if(user && user.isAdmin){ loadAllOrders() } else {
  document.getElementById('adminOrders').innerHTML = '<div class="sign-card">Orders are visible to admins only.</div>'
}
</script>
</body></html>